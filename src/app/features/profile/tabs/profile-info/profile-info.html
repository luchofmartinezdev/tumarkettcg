<div class="mb-8">
    <h2 class="text-2xl font-black text-slate-900 uppercase tracking-tighter">Mi <span
            class="text-blue-600">Perfil</span></h2>
    <p class="text-slate-400 font-medium text-sm mt-1">Tu información de cuenta.</p>
</div>

@if (authService.currentUser(); as user) {
<div class="flex flex-col gap-6 animate-in fade-in duration-500">

    <!-- Datos de cuenta -->
    <div
        class="bg-white rounded-[2rem] border border-slate-100 shadow-lg p-8 flex flex-col sm:flex-row items-center sm:items-start gap-6">
        <img [src]="user.photoURL" [alt]="user.displayName"
            class="h-24 w-24 rounded-2xl border-2 border-white shadow-lg ring-1 ring-slate-100 object-cover flex-shrink-0">

        <div class="flex flex-col gap-3 w-full">
            <div>
                <p class="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1">Nombre</p>
                <p class="text-lg font-black text-slate-900 uppercase tracking-tighter">{{ user.displayName }}</p>
            </div>
            <div>
                <p class="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1">Email</p>
                <p class="text-sm font-bold text-slate-700">{{ user.email }}</p>
            </div>
            <div>
                <p class="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1">Cuenta</p>
                <p class="text-sm font-bold text-slate-700">Google</p>
            </div>
            <div>
                <p class="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1">Cuenta creada</p>
                <p class="text-sm font-bold text-slate-700">{{ user.metadata.creationTime | date:'dd/MM/yyyy' }}</p>
            </div>
        </div>
    </div>

    <!-- Editar perfil público -->
    <div class="bg-white rounded-[2rem] border border-slate-100 shadow-lg p-8 flex flex-col gap-6 overflow-hidden">
        <div>
            <h3 class="text-sm font-black text-slate-900 uppercase tracking-tighter">Perfil público</h3>
            <p class="text-xs text-slate-400 font-medium mt-1">Esta información puede verse en tu perfil de vendedor.
            </p>
        </div>

        <!-- Ubicación -->
        <div class="flex flex-col gap-2">
            <label class="text-[9px] font-black text-slate-400 uppercase tracking-widest">
                Ubicación (ciudad / provincia)
            </label>
            <input type="text" [ngModel]="location()" (ngModelChange)="location.set($event)"
                placeholder="Ej: Córdoba, Córdoba"
                class="w-full bg-slate-50 border border-slate-200 rounded-2xl px-5 py-3 text-sm font-medium text-slate-700 focus:border-blue-500 focus:ring-4 focus:ring-blue-500/5 outline-none transition-all">
        </div>

        <!-- Toggle mostrar ubicación -->
        <div
            class="flex items-center justify-between gap-6 px-4 py-3 bg-slate-50 rounded-2xl border border-slate-100 w-full box-border">
            <div class="flex-1 min-w-0">
                <p class="text-sm font-black text-slate-700 uppercase tracking-tighter">Mostrar ubicación</p>
                <p class="text-xs text-slate-400 font-medium mt-0.5">Si está activo, tu ciudad se verá en tu perfil
                    público.</p>
            </div>

            <button type="button" role="switch" [attr.aria-checked]="showLocation()"
                (click)="showLocation.set(!showLocation())" [class]="showLocation() ? 'bg-blue-600' : 'bg-slate-200'"
                class="relative w-11 h-6 rounded-full transition-colors duration-200 shrink-0 cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500/30">

                <span [class]="showLocation() ? 'translate-x-5' : 'translate-x-0'"
                    class="absolute top-0.5 left-0.5 h-5 w-5 bg-white rounded-full shadow transition-transform duration-200 inline-block pointer-events-none">
                </span>
            </button>
        </div>

        <!-- Botón guardar -->
        <div class="flex items-center gap-4">
            <button (click)="saveProfile()" [disabled]="isSaving()"
                [class]="isSaving() ? 'opacity-60 cursor-not-allowed' : 'hover:bg-blue-700 active:scale-95'"
                class="px-8 py-3 bg-blue-600 text-white rounded-2xl text-[10px] font-black uppercase tracking-widest transition-all shadow-md shadow-blue-100">
                {{ isSaving() ? 'Guardando...' : 'Guardar cambios' }}
            </button>

            @if (savedOk()) {
            <div class="flex items-center gap-2 animate-in fade-in duration-300">
                <svg class="w-4 h-4 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 13l4 4L19 7" />
                </svg>
                <span class="text-[10px] font-black text-emerald-500 uppercase tracking-widest">Guardado</span>
            </div>
            }
        </div>
    </div>
</div>
}